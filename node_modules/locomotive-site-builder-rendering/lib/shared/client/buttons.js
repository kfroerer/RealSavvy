'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.insertAll = undefined;

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reactDom = require('react-dom');

var _reactDom2 = _interopRequireDefault(_reactDom);

var _button_group = require('../components/button_group');

var _button_group2 = _interopRequireDefault(_button_group);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function handleClick(type, blockId) {
  window.parent.postMessage({ type: type, block_id: blockId }, '*');
}

function insertAll() {
  document.querySelectorAll('[data-site-builder-block-id]').forEach(function (block) {
    var blockId = block.getAttribute('data-site-builder-block-id');
    var disableBtnGroup = block.getAttribute('data-site-builder-disable-buttons');
    var enableAddBtn = block.getAttribute('data-site-builder-block-add-block-below') !== 'false';
    var btnGroupId = 'site-builder-btn-group-' + blockId;
    var btnGroup = document.getElementById(btnGroupId);

    if (!btnGroup && disableBtnGroup !== '1') {
      // the "relative" position applied to a block is required
      // to display correctly the group of buttons
      var style = window.getComputedStyle(block);
      if (style.getPropertyValue('position') === '' || style.getPropertyValue('position') === 'static') block.style.position = 'relative';

      // insert the group of buttons
      var container = document.createElement('div');

      _reactDom2.default.render(_react2.default.createElement(_button_group2.default, {
        blockId: blockId,
        domId: btnGroupId,
        enableAddBtn: enableAddBtn,
        handleClick: handleClick
      }), container);

      block.appendChild(container);
    }
  });
}

exports.insertAll = insertAll;